var u=Object.defineProperty;var m=(h,e,s)=>e in h?u(h,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):h[e]=s;var a=(h,e,s)=>(m(h,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?i.credentials="include":t.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(t){if(t.ep)return;t.ep=!0;const i=s(t);fetch(t.href,i)}})();class x{constructor(e){a(this,"props");a(this,"skyGradient");this.props=e,this.skyGradient=this.props.ctx.createLinearGradient(0,0,0,this.props.size.y),this.skyGradient.addColorStop(0,"#00111e"),this.skyGradient.addColorStop(1,"#0a2342")}render(){const{ctx:e}=this.props;!this.skyGradient||(e.fillStyle=this.skyGradient,e.fillRect(0,0,this.props.size.x,this.props.size.y))}}const y=new Image;y.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'%3E%3Cg data-name='Layer 2'%3E%3Cg data-name='Layer 1'%3E%3Ccircle cx='25' cy='25' r='25' fill='%23fff797'/%3E%3Cellipse cx='29.19' cy='25.42' rx='20.81' ry='22.9' fill='%23e7dd88'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E";const l={score:0};function p(){const h=localStorage.getItem("flappy-user");if(!!h)try{const e=JSON.parse(h);l.score=e.score}catch(e){console.error(e)}}function g(){localStorage.setItem("flappy-user",JSON.stringify(l))}const f=document.getElementById("app");class w{constructor({user:e}){a(this,"canvas");a(this,"ctx");a(this,"time");a(this,"size");a(this,"score");a(this,"bird");a(this,"pipes");a(this,"gameOvered");a(this,"pipeConf");a(this,"difficulty");a(this,"sky");a(this,"gameStarted");this.canvas=document.createElement("canvas");const{canvas:s}=this,r=s.getContext("2d");if(!r)throw new Error;this.ctx=r,this.time=0,this.difficulty=0;const{x:t,y:i}=this.getSize();window.addEventListener("resize",this.handleResize.bind(this),{passive:!0}),this.size={x:t,y:i},s.width=t,s.height=i,s.addEventListener("click",this.handleClick.bind(this),{passive:!0}),window.addEventListener("keydown",this.handleClick.bind(this),{passive:!0}),this.bird={image:y,x:10,y:this.size.y/2,dy:0,size:50},this.pipes=[],this.score={current:0,best:e.score},this.pipeConf={width:120,xGap:600},this.createPipes(),this.sky=new x({ctx:this.ctx,size:this.size}),f.append(s),this.initialRender(),this.gameOvered=!1,this.gameStarted=!1}createPipes(){const{pipeConf:e}=this;this.pipes=[];for(let s=0,r=Math.max(this.size.x/e.xGap+1,2);s<r;s++)this.pipes.push({x:e.xGap+s*e.xGap,gap:this.size.y/2.5,topEnds:Math.random()*(this.size.y/2)})}getSize(){return{x:f.clientWidth,y:f.clientHeight}}handleResize(){const{canvas:e}=this,{x:s,y:r}=this.getSize();this.size.x=s,this.size.y=r,e.width=this.size.x,e.height=this.size.y,this.createPipes(),this.render(),this.gameOvered=!0}handleClick(){if(this.bird.dy=10,this.gameOvered){const{size:e,pipeConf:s}=this;this.gameOvered=!1,this.score.current=0,this.difficulty=0,this.bird.x=10,this.bird.y=e.y/2,this.pipes.forEach((r,t)=>{r.x=s.xGap+t*s.xGap,r.topEnds=Math.random()*(e.y/2)}),this.time=performance.now(),this.render()}else this.gameStarted||(this.gameStarted=!0,this.render())}handleGameOver(){const{best:e}=this.score;this.gameOvered=!0,e>l.score&&(l.score=e,g())}initialRender(){const{ctx:e,size:s,pipeConf:r,bird:t}=this;this.sky.render(),e.drawImage(t.image,t.x,t.y,t.size,t.size),e.fillStyle="#383838",this.pipes.forEach(i=>{i.x>=-r.width&&i.x<=s.x+r.width&&(e.fillRect(i.x,0,r.width,i.topEnds),e.fillRect(i.x,i.topEnds+i.gap,r.width,s.y))}),e.fillStyle="#f1f1f1",e.font="bold 20px 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",e.fillText(`Score : ${this.score.current}`,10,20),e.fillText(`Best : ${this.score.best}`,10,45)}render(e=16){const s=e-this.time,r=32<Math.abs(s)?16:s,{ctx:t,size:i,pipeConf:o}=this;this.time=e,this.score.current+=Math.floor(r);const{score:c}=this;this.score.best=c.best>c.current?c.best:c.current,this.difficulty=Math.min(c.current/(3e3*16),1.5),this.sky.render(),this.bird.y-=this.bird.dy-=r/32;const{bird:d}=this;if(t.drawImage(d.image,d.x,d.y,d.size,d.size),t.fillStyle="#383838",this.pipes.forEach(n=>{if(n.x-=r/(2-this.difficulty),n.x>=-o.width&&n.x<=i.x+o.width?(t.fillRect(n.x,0,o.width,n.topEnds),t.fillRect(n.x,n.topEnds+n.gap,o.width,i.y)):n.x<-o.width&&(n.x=(Math.ceil(i.x/o.xGap)+1)*o.xGap-o.width,n.topEnds=Math.random()*n.gap),(d.y<n.topEnds||d.y>n.topEnds+n.gap)&&n.x<d.size)return this.handleGameOver()}),t.fillStyle="#f1f1f1",t.font="bold 20px 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",t.fillText(`Score : ${this.score.current}`,10,20),t.fillText(`Best : ${this.score.best}`,10,45),d.y>i.y||this.gameOvered)return this.handleGameOver();window.requestAnimationFrame(this.render.bind(this))}}window.addEventListener("load",()=>{p(),new w({user:l})});
